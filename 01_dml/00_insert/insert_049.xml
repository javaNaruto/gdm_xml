<?xml version="1.0" encoding="GB2312" ?>
<!--
	修改记录列表
	序号		修改类型		修改内容			修改人		修改日期
	1		CREATE		CREATE FILE AND COMPLETE	FENGYUAN	2007-8-10										
-->
<!--
	测试点列表
	1.WITH CASCADED CHECK OPTION 将级联检查试图定义的查询字符串涉及到的所有表、视图
	2 WITH LOCAL CHECK OPTION将仅检查与视图定义直接相关的表、视图
	3 默认为CASCADED
-->
<SQLTEST>
	<CONTENT>  </CONTENT><!-- 请在这里加入对脚本的简要描述 -->
	<CONNECT></CONNECT><!-- 连接数据库 -->
	<!-- +++++++++++++++++++++ 初始化：开始 +++++++++++++++++++++ -->
	<SQL_CASE>
		<TYPE> DIRECT_EXECUTE_IGNORE </TYPE><!-- 忽略 -->
			<SQL> DROP VIEW V04_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V03_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V02_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V01_DDL_00421 CASCADE; </SQL>
			<SQL> DROP TABLE T01_DDL_00421 CASCADE; </SQL>
			
		<SQL> CREATE TABLE T01_DDL_00421(C INT ,B INT); </SQL>
		<SQL> INSERT INTO T01_DDL_00421 VALUES(1,10); </SQL>
		<SQL> INSERT INTO T01_DDL_00421 VALUES(2,40); </SQL>
		<SQL> INSERT INTO T01_DDL_00421 VALUES(3,90); </SQL>
		<SQL> INSERT INTO T01_DDL_00421 VALUES(4,160); </SQL>
		<SQL> CREATE VIEW V01_DDL_00421 AS SELECT * FROM T01_DDL_00421 WHERE MOD(C,2)=0; </SQL><!-- V01视图以C列为偶数为筛选条件 -->
	</SQL_CASE>
	<!-- - - - - - - - - - - - 初始化：结束 - - - - - - - - - - - -->
	
	<TestPointBegin>测试点1：开始 </TestPointBegin>
	<SQL_CASE>
		<SQL> CREATE VIEW V02_DDL_00421 AS SELECT * FROM V01_DDL_00421 WHERE B&gt;100 WITH CASCADED CHECK OPTION; </SQL><!-- V02以V01中B大于100为筛选条件 -->
		<TYPE> DIRECT_EXECUTE_SELECT_COMPARE_RESULT_FULL </TYPE><!-- 预期执行成功，并返回一个结果集，验证全字匹配长度 -->
		<SQL> SELECT * FROM V02_DDL_00421; </SQL>
		<RESULT>
			<RECORD>
				<COLUMN>4</COLUMN><COLUMN>160</COLUMN>
			</RECORD>
		</RESULT>
		<TYPE> DIRECT_EXECUTE_SUCCESS </TYPE><!-- 预期执行成功 -->
		<SQL> INSERT INTO V02_DDL_00421 VALUES(6,360); </SQL>
		<TYPE> DIRECT_EXECUTE_FAIL </TYPE><!-- 预期执行失败 --><!-- 必须满足两个视图的定义才能成功，否则插入失败 -->
		<SQL> INSERT INTO V02_DDL_00421 VALUES(5,250); </SQL><!-- C 的数值不满足V01的定义 而 B的数值满足V02的定义 -->
		<SQL> INSERT INTO V02_DDL_00421 VALUES(2,90); </SQL><!-- C 的数值满足V01的定义 而 B的数值不满足V02的定义 -->
		<SQL> INSERT INTO V02_DDL_00421 VALUES(3,70); </SQL><!-- C 的数值不满足V01的定义 且 B的数值不满足V02的定义 -->
		<TYPE> DIRECT_EXECUTE_SELECT_COMPARE_RESULT_FULL </TYPE><!-- 预期执行成功，并返回一个结果集，验证全字匹配长度 -->
		<SQL> SELECT * FROM T01_DDL_00421; </SQL>
		<RESULT>
			<RECORD>
				<COLUMN>1</COLUMN><COLUMN>10</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>2</COLUMN><COLUMN>40</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>3</COLUMN><COLUMN>90</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>4</COLUMN><COLUMN>160</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>6</COLUMN><COLUMN>360</COLUMN>
			</RECORD>
		</RESULT>
	</SQL_CASE>
	

	<TestPointBegin>测试点2：开始 </TestPointBegin>
	<SQL_CASE>
		<TYPE> DIRECT_EXECUTE_SUCCESS </TYPE><!-- 预期执行成功 -->
		<SQL>CREATE VIEW V03_DDL_00421 AS SELECT * FROM V01_DDL_00421 WHERE B&gt;100 WITH LOCAL CHECK OPTION; </SQL>
		<TYPE> DIRECT_EXECUTE_SUCCESS </TYPE><!-- 预期执行成功 -->
		<SQL> INSERT INTO V03_DDL_00421 VALUES(8,640); </SQL><!-- 满足V01,V03的定义 -->
		<SQL> INSERT INTO V03_DDL_00421 VALUES(7,640); </SQL><!-- 只满足V03的定义也是允许插入的 -->
		<TYPE> DIRECT_EXECUTE_FAIL </TYPE><!-- 预期执行失败 -->
		<SQL> INSERT INTO V03_DDL_00421 VALUES(8,80); </SQL><!-- 满足V01定义,但不满足V03的定义，不允许插入 -->
		<SQL> INSERT INTO V03_DDL_00421 VALUES(7,80); </SQL><!-- V01,V03的定义均不满足不允许插入 -->
		<TYPE> DIRECT_EXECUTE_SELECT_COMPARE_RESULT_FULL </TYPE><!-- 预期执行成功，并返回一个结果集，验证全字匹配长度 -->
		<SQL> SELECT * FROM T01_DDL_00421; </SQL>
		<RESULT>
			<RECORD>
				<COLUMN>1</COLUMN><COLUMN>10</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>2</COLUMN><COLUMN>40</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>3</COLUMN><COLUMN>90</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>4</COLUMN><COLUMN>160</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>6</COLUMN><COLUMN>360</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>8</COLUMN><COLUMN>640</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>7</COLUMN><COLUMN>640</COLUMN>
			</RECORD>
		</RESULT>
	</SQL_CASE>
	

	<TestPointBegin>测试点3：开始 </TestPointBegin>
	<SQL_CASE>
		<SQL> CREATE VIEW V04_DDL_00421 AS SELECT * FROM V01_DDL_00421 WHERE B&gt;100 WITH CHECK OPTION; </SQL><!-- V04以V01中B大于100为筛选条件 -->
		<TYPE> DIRECT_EXECUTE_SELECT_COMPARE_RESULT_FULL </TYPE><!-- 预期执行成功，并返回一个结果集，验证全字匹配长度 -->
		<SQL> SELECT * FROM V04_DDL_00421; </SQL>
		<RESULT>
			<RECORD>
				<COLUMN>4</COLUMN><COLUMN>160</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>6</COLUMN><COLUMN>360</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>8</COLUMN><COLUMN>640</COLUMN>
			</RECORD>
		</RESULT>
		<TYPE> DIRECT_EXECUTE_SUCCESS </TYPE><!-- 预期执行成功 -->
		<SQL> INSERT INTO V04_DDL_00421 VALUES(10,1000); </SQL>
		<TYPE> DIRECT_EXECUTE_FAIL </TYPE><!-- 预期执行失败 --><!-- 必须满足两个视图的定义才能成功，否则插入失败 -->
		<SQL> INSERT INTO V04_DDL_00421 VALUES(9,900); </SQL><!-- C 的数值不满足V01的定义 而 B的数值满足V04的定义 -->
		<SQL> INSERT INTO V04_DDL_00421 VALUES(2,90); </SQL><!-- C 的数值满足V01的定义 而 B的数值不满足V04的定义 -->
		<SQL> INSERT INTO V04_DDL_00421 VALUES(3,70); </SQL><!-- C 的数值不满足V01的定义 且 B的数值不满足V04的定义 -->
		<TYPE> DIRECT_EXECUTE_SELECT_COMPARE_RESULT_FULL </TYPE><!-- 预期执行成功，并返回一个结果集，验证全字匹配长度 -->
		<SQL> SELECT * FROM T01_DDL_00421; </SQL>
		<RESULT>
			<RECORD>
				<COLUMN>1</COLUMN><COLUMN>10</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>2</COLUMN><COLUMN>40</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>3</COLUMN><COLUMN>90</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>4</COLUMN><COLUMN>160</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>6</COLUMN><COLUMN>360</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>8</COLUMN><COLUMN>640</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>7</COLUMN><COLUMN>640</COLUMN>
			</RECORD>
			<RECORD>
				<COLUMN>10</COLUMN><COLUMN>1000</COLUMN>
			</RECORD>
		</RESULT>

	</SQL_CASE>
	


	<CLEAR><!-- 脚本清除模块，该关键字标识清除块开始 -->
		<SQL_CASE>
			<TYPE> DIRECT_EXECUTE_IGNORE </TYPE><!-- 忽略 -->
			<SQL> DROP VIEW V04_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V03_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V02_DDL_00421 CASCADE; </SQL>
			<SQL> DROP VIEW V01_DDL_00421 CASCADE; </SQL>
			<SQL> DROP TABLE T01_DDL_00421 CASCADE; </SQL>
		</SQL_CASE>
	</CLEAR>
</SQLTEST> 
